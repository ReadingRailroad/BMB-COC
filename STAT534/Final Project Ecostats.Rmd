---
title: "Ecostats Final Project"
author: "Martin Simonson"
date: "12/3/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}

df<-read.csv("2018/2018 Raw CPUE Data.csv", header = T)
str(df)

blue<-droplevels(subset(df, Lake == "Blue"))
blue<-blue[,-1]
str(blue)
head(blue)

blue$Date<-as.Date(with(df, paste(blue$Year,blue$Month,blue$Day, sep = "-")), "%Y-%m-%d")

blue2<-data.frame(blue$Date, blue$Run, blue$Effort, blue$n)
head(blue2)

effort<-aggregate(blue2["blue.Effort"], by = blue2["blue.Date"],sum)
catch<-aggregate(blue2["blue.n"], by = blue2["blue.Date"],sum)

cpue<-cbind(effort, catch$blue.n)
cpue

blue.cpue<-data.frame(cpue$blue.Date, cpue$`catch$blue.n`/cpue$blue.Effort)
colnames(blue.cpue)<- c("Date", "CPUE")
blue.cpue
```

# now to add environmental covariates
- water temp (data)
- noon air temp
- noon wind speed

```{r}
# water temps from data
watertemp<-read.csv("2018_COC_BIB_CMR_Data.csv")
watertemp<-droplevels(subset(watertemp, Lake == "Blue"))
watertemp<-watertemp[,c(1,18)]
summary(watertemp$Water.Temp..C.) # GREAT! non-existent data. Is there another way to get this?

# air temps from weather underground (farenheit at noon)
blue.cpue$AirTemp<-c(65,71,80,78,71,66,59,80,83,78,63,74,85,88,84,78,88,92,83,88,85,77,78,51,55,41)

# wind from weather underground (noon MPH)
blue.cpue$Wind<-c(10,13,16,5,18,14,16,10,13,18,6,13,18,5,9,9,15,14,18,13,8,9,7,7,16,12)

# changing farenheit to celcius
blue.cpue$AirTemp<-round((blue.cpue$AirTemp-32)*(5/9),1)
blue.cpue

# write csv
write.csv(blue.cpue, "Ecostats Project - CPUE.csv", row.names = F)
```

